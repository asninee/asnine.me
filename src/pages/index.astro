---
import Link from '@/components/Link.astro'
import NoteList from '@/components/NoteList.astro'
import Post from '@/components/Post.astro'
import Project from '@/components/Project.astro'
import Base from '@/layouts/Base.astro'
import { sortPostsByDate } from '@/lib/date'
import { getProjects } from '@/lib/projects'
import { getCollection } from 'astro:content'

const title = 'asnine â€¢ home'
const [projects, posts] = await Promise.all([
  getProjects(),
  (
    await sortPostsByDate(
      await getCollection('blog', ({ data }) => data.draft !== true)
    )
  ).slice(0, 4),
])
---

<Base {title} description='my personal site and blog'>
  <div class='flex gap-10 mt-10'>
    <div class='flex flex-col gap-4 md:gap-5'>
      <p>
        Hey! I'm <strong>Ashraf</strong>, a full-stack developer based in the
        UK. Currently working at <Link href='https://www.evelyn.com'
          >Evelyn Partners</Link
        >. Continously looking to hone my craft by building out simple,
        functional and elegant applications.
      </p>
      <p>
        My passion ties towards creating services that can bring forward
        transformative changes to society, where the emergence of touch-based
        devices fascinated me as a kid.
      </p>
      <p>
        I love exploring the latest and greatest in the tech sphere, where I
        value high-quality products that are utilitarian in nature, but also
        incorporate a sleek aesthetic.
      </p>
    </div>
  </div>

  <div class='mt-12'></div>
  <small class='text-l/sec dark:text-d/sec'>Projects</small>
  <ul class='mt-2'>
    {
      projects.map(p => (
        <li class='list-none'>
          <Project link={p.link} repo={p.repo} desc={p.desc} year={p.year} />
        </li>
      ))
    }
  </ul>

  <div class='mt-12 flex items-center justify-between'>
    <small class='text-l/sec dark:text-d/sec'>Blog</small>
    <Link lg href='/blog'><small class='font-medium'>View all</small></Link>
  </div>
  <ul>
    {
      posts.map(p => (
        <li class='list-none'>
          <Post
            slug={p.slug}
            title={p.data.title}
            desc={p.data.desc}
            date={p.data.updated ?? p.data.published}
          />
        </li>
      ))
    }
  </ul>

  <div class='mt-12 flex items-center justify-between'>
    <small class='text-l/sec dark:text-d/sec'>Notepad</small>
    <Link lg href='/notepad'><small class='font-medium'>View all</small></Link>
  </div>
  <NoteList class='mt-2' />
</Base>
